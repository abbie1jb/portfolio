<!DOCTYPE HTML>
<!--
	Prologue by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Prologue by HTML5 UP</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">

		<!-- Header -->
			<div id="header">

				<div class="top">

					<!-- Logo -->
						<div id="logo">
							<span class="image avatar48"><img src="bam.jpg" alt="" /></span>
							<h1 id="title">Abbie Bambrough</h1>
							<p>Product Design</p>
						</div>

					<!-- Nav -->
						<nav id="nav">
							<ul>
								<li><a href="#top" id="top-link"><span class="icon solid fa-home">Intro</span></a></li>
								<li><a href="#portfolio" id="portfolio-link"><span class="icon solid fa-th">Portfolio</span></a></li>
								<li><a href="#about" id="about-link"><span class="icon solid fa-user">About Me</span></a></li>
								<li><a href="#contact" id="contact-link"><span class="icon solid fa-envelope">Contact</span></a></li>
							</ul>
						</nav>

				</div>

				<div class="bottom">

					<!-- Social Icons -->
						<ul class="icons">
							<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
							<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
							<li><a href="#" class="icon brands fa-github"><span class="label">Github</span></a></li>
							<li><a href="#" class="icon brands fa-dribbble"><span class="label">Dribbble</span></a></li>
							<li><a href="#" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
						</ul>

				</div>

			</div>

		<!-- Main -->
			<div id="main">

				<!-- Intro -->
					<section id="top" class="one dark cover">
						<div class="container">

							<header>
								<h2 class="alt">Hi! I'm <strong>Prologue</strong>, a <a href="http://html5up.net/license">free</a> responsive<br />
								site template designed by <a href="http://html5up.net">HTML5 UP</a>.</h2>
								<p>Ligula scelerisque justo sem accumsan diam quis<br />
								vitae natoque dictum sollicitudin elementum.</p>
							</header>

							<footer>
								<a href="#portfolio" class="button scrolly">See my work</a>
							</footer>

						</div>
					</section>

				<!-- Portfolio -->
					<section id="portfolio" class="two">
						<div class="container">

							<header>
								<h2>Portfolio</h2>
							</header>

							<p>Vitae natoque dictum etiam semper magnis enim feugiat convallis convallis
							egestas rhoncus ridiculus in quis risus amet curabitur tempor orci penatibus.
							Tellus erat mauris ipsum fermentum etiam vivamus eget. Nunc nibh morbi quis
							fusce hendrerit lacus ridiculus.</p>

							<div class="row" id="work-display-container"></div>

						</div>
					</section>

				<!-- About Me -->
					<section id="about" class="three">
						<div class="container">

							<header>
								<h2>About Me</h2>
							</header>

							<a href="#" class="image featured"><img src="about.jpg" alt="" /></a>

							<p>Tincidunt eu elit diam magnis pretium accumsan etiam id urna. Ridiculus
							ultricies curae quis et rhoncus velit. Lobortis elementum aliquet nec vitae
							laoreet eget cubilia quam non etiam odio tincidunt montes. Elementum sem
							parturient nulla quam placerat viverra mauris non cum elit tempus ullamcorper
							dolor. Libero rutrum ut lacinia donec curae mus vel quisque sociis nec
							ornare iaculis.</p>

						</div>
					</section>

				<!-- Contact -->
					<section id="contact" class="four">
						<div class="container">

							<header>
								<h2>Contact</h2>
							</header>

							<p>Elementum sem parturient nulla quam placerat viverra
							mauris non cum elit tempus ullamcorper dolor. Libero rutrum ut lacinia
							donec curae mus. Eleifend id porttitor ac ultricies lobortis sem nunc
							orci ridiculus faucibus a consectetur. Porttitor curae mauris urna mi dolor.</p>

							<form method="post" action="#">
								<div class="row">
									<div class="col-6 col-12-mobile"><input type="text" name="name" placeholder="Name" /></div>
									<div class="col-6 col-12-mobile"><input type="text" name="email" placeholder="Email" /></div>
									<div class="col-12">
										<textarea name="message" placeholder="Message"></textarea>
									</div>
									<div class="col-12">
										<input type="submit" value="Send Message" />
									</div>
								</div>
							</form>

						</div>
					</section>

			</div>

		<!-- Footer -->
			<div id="footer">

				<!-- Copyright -->
					<ul class="copyright">
						<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>

			</div>

		<!-- Scripts -->
			<script>
				// Capture detailed errors and unhandled promise rejections to help debugging.
				window.addEventListener('error', function (e) {
					try {
						console.error('Captured error:', e.message, e.filename + ':' + e.lineno + ':' + e.colno);
						if (e.error && e.error.stack) console.error('Stack:', e.error.stack);
					} catch (err) {
						console.error('Error while reporting error:', err);
					}
				});
				window.addEventListener('unhandledrejection', function (e) {
					try {
						console.error('Unhandled rejection:', e.reason && (e.reason.stack || e.reason));
					} catch (err) {
						console.error('Error while reporting rejection:', err);
					}
				});
			</script>
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script>
				// Initialize portfolio display
				document.addEventListener('DOMContentLoaded', function() {
					try {
						var container = document.getElementById('work-display-container');
						if (!container) {
							console.warn('work-display-container not found; skipping portfolio display.');
							return;
						}

						function createPortfolioElement(name, imageUrl, idx) {
							var col = document.createElement('div');
							col.className = 'col-4 col-12-mobile';

							var article = document.createElement('article');
							article.className = 'item';

							// Create an image element for the portfolio item
							var img = document.createElement('img');
							img.src = imageUrl;
							img.alt = name || ('Item ' + (idx + 1));
							img.style.width = '100%';
							img.style.height = '300px';
							img.style.objectFit = 'cover';
							img.style.border = '1px solid #ddd';
							img.style.borderRadius = '4px';
							img.style.overflow = 'hidden';

							article.appendChild(img);

							var header = document.createElement('header');
							var h3 = document.createElement('h3');
							h3.textContent = name || ('Item ' + (idx + 1));
							header.appendChild(h3);
							article.appendChild(header);

							col.appendChild(article);
							container.appendChild(col);

							// Make the portfolio item clickable
							article.style.cursor = 'pointer';
							article.addEventListener('click', function() {
								window.location.href = 'detail.html?project=' + encodeURIComponent(name);
							});
						}

						// Parse an HTML directory listing and return folder hrefs (that end with '/')
						function parseDirectoryListing(html) {
							var parser = new DOMParser();
							var doc = parser.parseFromString(html, 'text/html');
							var anchors = Array.from(doc.querySelectorAll('a[href]'));
							return anchors.map(function(a) { return a.getAttribute('href'); })
								.filter(function(h) { return h && h.endsWith('/'); })
								.filter(function(h) { return h !== '../'; });
						}

						// Find the first image in a chunk folder
						function findFirstImageInChunk(chunkPath) {
							return fetch(chunkPath).then(function(res) {
								if (!res.ok) return null;
								return res.text();
							}).then(function(text) {
								if (!text) return null;
								// Look for image file links
								var imageMatch = text.match(/href=["']([^"']+\.(jpe?g|jpeg|png|gif|webp))["']/i);
								if (imageMatch) {
									var candidate = imageMatch[1];
									// If candidate is relative, prefix chunkPath
									if (/^https?:|^\//i.test(candidate)) return candidate;
									return chunkPath + candidate;
								}
								return null;
							}).catch(function() {
								return null;
							});
						}

						// Find display image for project thumbnail
						function findDisplayImage(projectPath) {
							var displayImagePath = projectPath + 'DISPLAY_IMAGE/';
							return fetch(displayImagePath).then(function(res) {
								if (!res.ok) return null;
								return res.text();
							}).then(function(text) {
								if (!text) return null;
								// Look for image file links
								var imageMatch = text.match(/href=["']([^"']+\.(jpe?g|jpeg|png|gif|webp))["']/i);
								if (imageMatch) {
									var candidate = imageMatch[1];
									// If candidate is relative, prefix displayImagePath
									if (/^https?:|^\//i.test(candidate)) return candidate;
									return displayImagePath + candidate;
								}
								return null;
							}).catch(function() {
								return null;
							});
						}

						// Find first chunk image as fallback
						function findFirstChunkImage(projectPath) {
							return fetch(projectPath).then(function(res) {
								if (!res.ok) return null;
								return res.text();
							}).then(function(text) {
								if (!text) return null;
								var folders = parseDirectoryListing(text);
								// Look for chunk folders (skip special folders)
								var chunkFolders = folders.filter(function(folder) {
									var folderName = folder.replace(/\/$/, '');
									return folderName !== 'DISPLAY_IMAGE' && 
										   folderName !== 'RENDER_IMAGES' && 
										   folderName !== 'CAD_MODEL' && 
										   folderName !== 'OLD_STRUCTURE';
								});
								
								if (chunkFolders.length === 0) return null;
								
								// Try to find first image in first chunk
								var firstChunkPath = projectPath + chunkFolders[0];
								return findFirstImageInChunk(firstChunkPath);
							}).catch(function() {
								return null;
							});
						}

						function scanWorkDisplay() {
							return fetch('WORK_DISPLAY/').then(function(res) {
								if (!res.ok) throw new Error('WORK_DISPLAY directory fetch failed: ' + res.status);
								return res.text();
							}).then(function(html) {
								var folders = parseDirectoryListing(html);
								if (!folders || folders.length === 0) {
									throw new Error('No folders found in WORK_DISPLAY directory listing');
								}
								var counter = 0;
								var tasks = folders.map(function(folderHref) {
									var projectName = folderHref.replace(/\/$/, '');
									var projectPath = 'WORK_DISPLAY/' + folderHref;
									
									// First try to find display image
									return findDisplayImage(projectPath).then(function(imageUrl) {
										if (!imageUrl) {
											// Fallback to first chunk image
											return findFirstChunkImage(projectPath);
										}
										return imageUrl;
									}).then(function(imageUrl) {
										if (imageUrl) {
											createPortfolioElement(projectName, imageUrl, counter++);
										} else {
											console.warn('No images found in project:', projectName);
										}
									}).catch(function(err) {
										console.warn('Error scanning project', projectName, err);
									});
								});
								return Promise.all(tasks);
							});
						}

						// Scan WORK_DISPLAY directory for projects
						scanWorkDisplay().catch(function(err) {
							console.error('Failed to load WORK_DISPLAY items:', err);
						});
					} catch (e) {
						console.error('Fatal error during DOMContentLoaded init:', e && e.stack ? e.stack : e);
					}
				});
			</script>

	</body>
</html>
